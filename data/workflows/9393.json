{"id":"HaeyHJ55hJdqFWXF","meta":{"instanceId":"81fbc47f2c7361dad100f5803eda7f24983f8844d7b7d1688ed0eec2a021756c"},"name":"Colde Email Gen","tags":[],"nodes":[{"id":"4b4b6802-06d6-48b9-8a28-1b6d2d05de78","name":"Add to Google Sheet","type":"n8n-nodes-base.googleSheets","position":[1600,528],"parameters":{"columns":{"value":{"Email":"={{ $json.output.email }}","Title":"={{ $json.output.title }}","PRASER":"={{ $('Parse Lead Data').item.json.output }}","Full Name":"={{ $json.output.fullName }}","AI Summary":"={{ $json.output.summary }}","Company Name":"={{ $json.output.companyName }}","Company Website":"={{ $json.output.companyWebsite }}","Company LinkedIn":"={{ $json.output.companyLinkedIn }}","Personal LinkedIn":"={{ $json.output.LinkedIn }}"},"schema":[{"id":"Full Name","type":"string","display":true,"removed":false,"required":false,"displayName":"Full Name","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Email","type":"string","display":true,"required":false,"displayName":"Email","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Title","type":"string","display":true,"required":false,"displayName":"Title","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Personal LinkedIn","type":"string","display":true,"required":false,"displayName":"Personal LinkedIn","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Company Name","type":"string","display":true,"required":false,"displayName":"Company Name","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Company Website","type":"string","display":true,"required":false,"displayName":"Company Website","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Company LinkedIn","type":"string","display":true,"required":false,"displayName":"Company LinkedIn","defaultMatch":false,"canBeUsedToMatch":true},{"id":"AI Summary","type":"string","display":true,"required":false,"displayName":"AI Summary","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Mail","type":"string","display":true,"removed":false,"required":false,"displayName":"Mail","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Wysłany?","type":"string","display":true,"removed":false,"required":false,"displayName":"Wysłany?","defaultMatch":false,"canBeUsedToMatch":true},{"id":"PRASER","type":"string","display":true,"removed":false,"required":false,"displayName":"PRASER","defaultMatch":false,"canBeUsedToMatch":true},{"id":"MAIL","type":"string","display":true,"removed":false,"required":false,"displayName":"MAIL","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["Full Name"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"append","sheetName":{"__rl":true,"mode":"list","value":595949380,"cachedResultUrl":"https://docs.google.com/spreadsheets/d/1fbk-IZwfXj9kmQR98VhSBiFek6_fVSg10_W0IkGIvhA/edit#gid=595949380","cachedResultName":"doradcy"},"documentId":{"__rl":true,"mode":"list","value":"1fbk-IZwfXj9kmQR98VhSBiFek6_fVSg10_W0IkGIvhA","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1fbk-IZwfXj9kmQR98VhSBiFek6_fVSg10_W0IkGIvhA/edit?usp=drivesdk","cachedResultName":"apollo"}},"credentials":{"googleSheetsOAuth2Api":{"id":"f4By4zSkpxEHAFsW","name":"ccu"}},"typeVersion":4.5},{"id":"e65236a6-d58e-4370-9270-8d16cac6c3fb","name":"On form submission","type":"n8n-nodes-base.formTrigger","position":[800,96],"webhookId":"ba6e9c2d-ed5d-45f0-98c9-9a1c39496dd6","parameters":{"options":{},"formTitle":"Apollo + Apify Lead Generation","formFields":{"values":[{"fieldLabel":"Job Title","placeholder":"Founder, Engineer, Owner"},{"fieldType":"dropdown","fieldLabel":"Company Size","fieldOptions":{"values":[{"option":"1-10"},{"option":"11-50"},{"option":"51-200"},{"option":"201-1000"},{"option":"10001-5000"},{"option":"5001-10000"},{"option":"10001-100000"}]}},{"fieldLabel":"Keywords","placeholder":"Keywords relevant to the contact or company"},{"fieldLabel":"Location","placeholder":"United States, California, London"}]},"formDescription":"Describe the types of leads you are trying to find."},"typeVersion":2.2},{"id":"06b9b08c-c859-4825-813b-d4d03e068a0a","name":"Apollo URL Generator","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[1008,96],"parameters":{"text":"=Job Title: {{ $json['Job Title'] }}\n\nCompany Size: {{ $json['Company Size'] }}\n\nKeywords: {{ $json.Keywords }}\n\nLocation: {{ $json.Location }}\n\n\n","batching":{},"messages":{"messageValues":[{"message":"=You are an expert Apollo search URL generator.\n\nYour task is to take key-value data from a form submission and turn it into a precise Apollo Search URL. You will only receive input for the fields listed below.\n\nSupported Search Fields\nYou only support the following four fields from the form input:\n\npersonLocation: The location of the person. Maps to the personLocations[] parameter.\njobTitle: The person's job title. Maps to the personTitles[] parameter.\ncompanySize: The employee range of the company. Maps to the organizationNumEmployeesRanges[] parameter.\nkeywords: Specific keyword tags for the organization. Maps to the qOrganizationKeywordTags[] parameter.\nDo not add or infer any other fields or parameters.\n\nURL Template\nUse the following URL template:\n\n\nhttps://app.apollo.io/#/people?{field1}={value1}&{field2}={value2}&...\n\n\n\n\nExample:\n\nInput\npersonLocation: New York\njobTitle: VP of Engineering\ncompanySize: 51-200\nkeywords: Healthcare AI\n\n\nOutput\n\nhttps://app.apollo.io/#/people?personLocations[]=New%20York&personTitles[]=VP%20of%20Engineering&organizationNumEmployeesRanges[]=51%2C200&qOrganizationKeywordTags[]=Healthcare%20AI"}]},"promptType":"define"},"typeVersion":1.7},{"id":"1c966679-8a61-43da-a277-233a7aaa06f2","name":"Run Apify","type":"n8n-nodes-base.httpRequest","position":[1296,96],"parameters":{"url":"https://api.apify.com/v2/acts/pipelinelabs~lead-scraper-apollo-zoominfo-lusha/run-sync-get-dataset-items?token=apify_api_YOUR_TOKEN_HERE","method":"POST","options":{},"jsonBody":"={\n    \"companyCountry\": [\n        \"Poland\"\n    ],\n    \"companyEmployeeSize\": [\n        \"2 - 10\",\n        \"11 - 50\"\n    ],\n    \"companyIndustry\": [\n        \"Financial Services\"\n    ],\n    \"hasEmail\": true,\n    \"hasPhone\": false,\n    \"personCountry\": [\n        \"Poland\"\n    ],\n    \"seniority\": [\n        \"Owner\"\n    ]\n}","sendBody":true,"sendHeaders":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth","headerParameters":{"parameters":[{"name":"Accept","value":"application/json"},{"name":"Authorization","value":"Bearer "}]}},"credentials":{"httpBearerAuth":{"id":"60i8DkYR1DqARkuQ","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.2},{"id":"c755b5ac-926b-446d-9ec0-52b6dcb113eb","name":"Limit","type":"n8n-nodes-base.limit","position":[576,512],"parameters":{"maxItems":5},"typeVersion":1},{"id":"a2911e3b-332e-47f2-8e09-623156872a8c","name":"Structured Output Parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","position":[912,656],"parameters":{"jsonSchemaExample":"{\n  \"fullName\": \"Stefan Chira\",\n  \"email\": \"stefan@quantumturf.com\",\n  \"title\": \"Founder\",\n  \"LinkedIn\": \"http://www.linkedin.com/in/stefanchira\",\n  \"companyName\": \"Quantum Turf\",\n  \"companyWebsite\": \"http://www.quantumturf.com\",\n  \"companyLinkedIn\": \"http://www.linkedin.com/company/quantumturf\",\n  \"summary\": \"Stefan Chira is the Founder of Quantum Turf...\"\n}"},"typeVersion":1.2},{"id":"a2bd2bb6-7c58-473c-940f-b021a6df99bf","name":"Parse Lead Data","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[752,512],"parameters":{"text":"=Name: {{ $json.name }}\n\nTitle: {{ $json.title }}\n\nEmail: {{ $json.email }}\n\nLinkedIn: {{ $json.linkedin_url }}\n\nOrg Name: {{ $json.organization_name }}\n\nOrg Website: {{ $json.organization_website_url }}\n\nOrg LinkedIn: {{ $json.organization_linkedin_url }}\n\n\n\n","batching":{},"messages":{"messageValues":[{"message":"=You are a sophisticated AI data-processing engine. Your task is to receive a raw JSON object for a single business prospect, perform two critical actions, and then provide your response in a specific JSON format.\n\n**Your Instructions:**\n\n1.  **EXTRACT KEY DATA:** You must parse the raw JSON input to find and extract the following specific data points. If a field is not present, use a value of `BRAK`.\n    * **Full Name:** Look for `first_name` and `last_name`.\n    * **Email:** Find the first available email address. Look in fields like `emails` or `personal_emails` .\n    * **LinkedIn** Look for the 'linkedin_url'\n    * **Title:** Look for the `title` field.\n    * **Company Name:** Look for the `organization_name` field.\n    * **Company Website:** Look for the `organization_website` field.\n    * **Company LinkedIn:** Combine `organization_linkedin.\n\n2.  **SYNTHESIZE A SUMMARY:** After extracting the data, write a concise, 2-3 sentence professional summary suitable for a sales team.\n\n3.  **FORMAT THE OUTPUT:** You MUST structure your entire response as a single, clean JSON object. The object should contain exactly the keys listed below. Do not include any other text, explanations, or greetings in your response—ONLY the final JSON object.\n\n**Required Output Format:**\n{\n  \"fullName\": \"...\",\n  \"email\": \"...\",\n  \"title\": \"...\",\n  \"LinkedIn\"\n  \"companyName\": \"...\",\n  \"companyWebsite\": \"...\",\n  \"companyLinkedIn\": \"...\",\n  \"summary\": \"...\"\n}"}]},"promptType":"define","hasOutputParser":true},"typeVersion":1.7},{"id":"820ce9cc-edfb-4ca4-953f-e225f2e4975e","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-32,-64],"parameters":{"color":5,"width":500,"height":800,"content":"BY MIRAI\n\nAPIFY ACTOR\n### -  https://console.apify.com/actors/jljBwyyQakqrL1wae/input\n\n\n"},"typeVersion":1},{"id":"023da3f8-2872-4c8a-97cc-ead84c741d92","name":"If","type":"n8n-nodes-base.if","position":[1024,512],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"0c3299a2-95c2-472e-b4b1-023d935dd2d9","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json.output.email }}","rightValue":"BRAK"}]}},"typeVersion":2.2},{"id":"6732b35a-7d00-431b-b959-ee1b9ce05ed0","name":"Loop Over Items1","type":"n8n-nodes-base.splitInBatches","position":[2304,528],"parameters":{"options":{}},"typeVersion":3},{"id":"4231bbd5-78da-41a6-b07b-14c7f56d08f8","name":"Wait","type":"n8n-nodes-base.wait","position":[2672,720],"webhookId":"1141ae77-a350-4d6d-b4c1-6e20910f5c89","parameters":{"unit":"minutes","amount":10},"typeVersion":1.1},{"id":"42268bfc-af7b-4fe5-bef6-18e2bcf8a28d","name":"No Operation, do nothing","type":"n8n-nodes-base.noOp","position":[2736,368],"parameters":{},"typeVersion":1},{"id":"f098ad71-fb9e-4afc-8aef-7c6f030d8de0","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[592,-192],"parameters":{"width":864,"height":464,"content":"## START\nIn this section, a form pops up where we enter our leads' preferences\n\nPOSITION\nCOMPANY SIZE\nLOCATION\nKEYWORDS\n\nThis data is then transferred to the Link Generator (connect your OPEANAI CREDENTIAL here) and then to the Actor in APIFY.\n\nIn the RUN APIFY node\n\nIn the Bearer YOUR_TOKEN_HERE tab\nENTER your API key"},"typeVersion":1},{"id":"6e6b16c4-744d-492d-820f-dd9c7fe0dfb9","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[480,320],"parameters":{"width":928,"height":384,"content":"## Parse Lead Data\nIn Nodae, you specify the number of leads you want to convert into emails.\n\nParse Lead Data - Analyze the data collected from Apify results and SYNTHESIZE A SUMMARY for each potential customer to prepare a better email."},"typeVersion":1},{"id":"9c96c62a-7a96-4967-a991-4f145317a422","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[1536,96],"parameters":{"color":5,"width":228,"height":608,"content":"## SORTING\n\nIn this section, leads are divided into two groups: those who have an email address and those who do not. \n\nWe recommend dividing them into two different sheets so that you can use these leads later.\n"},"typeVersion":1},{"id":"646d5457-ee42-4b79-8f72-68de028cae81","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[1856,304],"parameters":{"color":5,"width":228,"height":384,"content":"## EMAIl MAGIC\n\nThis is where the magic happens.\n\nThe data we receive from APIFY is used to create personalized emails.\nIndividually for each lead."},"typeVersion":1},{"id":"0452b6ac-e352-4066-b465-2839adce0803","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","position":[2192,-112],"parameters":{"width":864,"height":1056,"content":"## Sending emails\n\nThis is where emails are sent\n- The Loop node allows you to send each email individually.\n\n- If you use a @gmail.com email address, connect it to the system instead of the Sending cold email Gmail node and log in to the mailbox from which you want to send emails. The rest is connected for you (just change the SUBJECT LINE TO YOUR PREFERENCES).\nThe same applies to Outlook mailboxes\nIf you use a mailbox with your own domain, leave the Sending cold email node, enter your credentials (if you do not know all the details, ask your mailbox operator, they will definitely help you), and the rest is set up for you, except for SL, of course \n\n- NODE wait creates a pause between sending individual emails. By opening it, you can set how often they should be sent. This prevents all emails from being sent at once, which could expose your messages and address to being marked as spam\n\n- message confirming end of work NODE after the LOOP process is complete, sends a message to the mailbox you selected informing you that all emails have been sent "},"typeVersion":1},{"id":"2754efe3-96c1-43b6-b6c2-8b36a2582b12","name":"message confirming end of work","type":"n8n-nodes-base.gmail","position":[2528,368],"webhookId":"46e5a229-f43c-4494-8de2-789806ca7bc2","parameters":{"message":"All emails send","options":{},"subject":"WORK DONE"},"credentials":{"gmailOAuth2":{"id":"V1fKvLRJh7V1DfwB","name":"Gmail account 2"}},"executeOnce":true,"typeVersion":2.1},{"id":"3a3080f4-cac6-4f36-b3d6-0ecfa0f9fadc","name":"Sending cold email","type":"n8n-nodes-base.emailSend","position":[2512,560],"webhookId":"0c4969af-fcd7-4bd0-b07c-6461b57111ed","parameters":{"text":"={{ $json.message.content }}","options":{},"subject":"Nowe leady","toEmail":"kontakt@miraiautomation.xyz","fromEmail":"={{ $('Add to Google Sheet').item.json.Email }}","emailFormat":"text"},"credentials":{"smtp":{"id":"vc0fQqyoJySlvmvL","name":"SMTP account 2"}},"typeVersion":2.1},{"id":"dd5e530f-c93d-403d-adaa-27f7f8472d8a","name":"Sending cold email Gmail","type":"n8n-nodes-base.gmail","position":[2688,560],"webhookId":"00085c8a-134d-4e0b-ab03-0584bc6ac749","parameters":{"sendTo":"={{ $('Add to Google Sheet').item.json.Email }}","message":"={{ $json.message.content }}","options":{"appendAttribution":false},"subject":"Brzmi znajomo?","emailType":"text"},"credentials":{"gmailOAuth2":{"id":"V1fKvLRJh7V1DfwB","name":"Gmail account 2"}},"typeVersion":2.1},{"id":"1fae88ea-4338-43b8-8c1a-fe02bfba8809","name":"Creating a email","type":"@n8n/n8n-nodes-langchain.openAi","position":[1856,528],"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-5","cachedResultName":"GPT-5"},"options":{},"messages":{"values":[{"content":"=Użwyając tych danych  {{ $('Parse Lead Data').item.json.output }}\nPrzerób ponizszą wiadomośc w taki spsób aby brzmiała jak przygotowane specjalnie dla tej osoby\n\nWzór maila:\n\nHej {{ $json['Full Name'] }},\n\nczy w {{ $json['Company Name'] }} cold mailing działa tak, jakbyś chciał?\nPytam, bo stworzyliśmy system, który sam generuje leady i follow-upy —\na zespół dostaje tylko gotowe rozmowy.\n\nBrzmi jak coś, co mogłoby się sprawdzić w {{ $json['Company Name'] }}?\n\nNie zmieniaj sensu, struktury i języka maila podmień tylko dane które otrzymałeś nic więcej,\n\nOdpowiadaj tylko gotowym mailem, nie dodawaj nic więcej"}]}},"credentials":{"openAiApi":{"id":"cRv8DoMwA95Md5fb","name":"OpenAi account 3"}},"typeVersion":1.8},{"id":"415b1cb5-11da-44cf-b882-20dcb630df59","name":"Leads without email","type":"n8n-nodes-base.googleSheets","position":[1600,384],"parameters":{"columns":{"value":{"Email":"={{ $json.output.email }}","Title":"={{ $json.output.title }}","Full Name":"={{ $json.output.fullName }}","AI Summary":"={{ $json.output.summary }}","Company Name":"={{ $json.output.companyName }}","Company Website":"={{ $json.output.companyWebsite }}","Company LinkedIn":"={{ $json.output.companyLinkedIn }}","Personal LinkedIn":"={{ $json.output.LinkedIn }}"},"schema":[{"id":"Full Name","type":"string","display":true,"removed":false,"required":false,"displayName":"Full Name","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Email","type":"string","display":true,"required":false,"displayName":"Email","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Title","type":"string","display":true,"required":false,"displayName":"Title","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Personal LinkedIn","type":"string","display":true,"required":false,"displayName":"Personal LinkedIn","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Company Name","type":"string","display":true,"required":false,"displayName":"Company Name","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Company Website","type":"string","display":true,"required":false,"displayName":"Company Website","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Company LinkedIn","type":"string","display":true,"required":false,"displayName":"Company LinkedIn","defaultMatch":false,"canBeUsedToMatch":true},{"id":"AI Summary","type":"string","display":true,"required":false,"displayName":"AI Summary","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Mail","type":"string","display":true,"removed":true,"required":false,"displayName":"Mail","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Wysłany?","type":"string","display":true,"removed":true,"required":false,"displayName":"Wysłany?","defaultMatch":false,"canBeUsedToMatch":true},{"id":"row_number","type":"number","display":true,"removed":true,"readOnly":true,"required":false,"displayName":"row_number","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["Full Name"],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"appendOrUpdate","sheetName":{"__rl":true,"mode":"list","value":595949380,"cachedResultUrl":"https://docs.google.com/spreadsheets/d/1fbk-IZwfXj9kmQR98VhSBiFek6_fVSg10_W0IkGIvhA/edit#gid=595949380","cachedResultName":"doradcy"},"documentId":{"__rl":true,"mode":"list","value":"1fbk-IZwfXj9kmQR98VhSBiFek6_fVSg10_W0IkGIvhA","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1fbk-IZwfXj9kmQR98VhSBiFek6_fVSg10_W0IkGIvhA/edit?usp=drivesdk","cachedResultName":"apollo"}},"credentials":{"googleSheetsOAuth2Api":{"id":"f4By4zSkpxEHAFsW","name":"ccu"}},"typeVersion":4.7},{"id":"bce0c041-9054-40d8-bd2e-cda784590888","name":"Parse Data module","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[688,656],"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4.1-mini","cachedResultName":"gpt-4.1-mini"},"options":{}},"credentials":{"openAiApi":{"id":"sp1N9oDRVcWik32U","name":"rifff"}},"typeVersion":1.2},{"id":"ce63c6f3-b62f-45aa-b8ec-3cbb86c11390","name":"LINK PASER","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[928,192],"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-5","cachedResultName":"gpt-5"},"options":{}},"credentials":{"openAiApi":{"id":"cRv8DoMwA95Md5fb","name":"OpenAi account 3"}},"typeVersion":1.2}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"4a0d08e6-0d1c-4b52-b14d-5b777fbcc6db","connections":{"If":{"main":[[{"node":"Leads without email","type":"main","index":0}],[{"node":"Add to Google Sheet","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Limit":{"main":[[{"node":"Parse Lead Data","type":"main","index":0}]]},"Run Apify":{"main":[[{"node":"Limit","type":"main","index":0}]]},"LINK PASER":{"ai_languageModel":[[{"node":"Apollo URL Generator","type":"ai_languageModel","index":0}]]},"Parse Lead Data":{"main":[[{"node":"If","type":"main","index":0}]]},"Creating a email":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Loop Over Items1":{"main":[[{"node":"message confirming end of work","type":"main","index":0}],[{"node":"Sending cold email","type":"main","index":0}]]},"Parse Data module":{"ai_languageModel":[[{"node":"Parse Lead Data","type":"ai_languageModel","index":0}]]},"On form submission":{"main":[[{"node":"Apollo URL Generator","type":"main","index":0}]]},"Sending cold email":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Add to Google Sheet":{"main":[[{"node":"Creating a email","type":"main","index":0}]]},"Apollo URL Generator":{"main":[[{"node":"Run Apify","type":"main","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Parse Lead Data","type":"ai_outputParser","index":0}]]},"message confirming end of work":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}]]}}}