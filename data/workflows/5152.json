{"id":"tMuFNayeeZYimHLR","meta":{"instanceId":"88b34e051213082619adc89dcb3c4c6a3611f57a17080c0af86efd3b8840b94f","templateCredsSetupCompleted":true},"name":"[MW] AI Customer Support Assistant - Cloud Version","tags":[],"nodes":[{"id":"b617607e-61ae-4107-a72e-2a23b5a57c75","name":"ğŸ“‹ Workflow Overview","type":"n8n-nodes-base.stickyNote","position":[0,0],"parameters":{"width":450,"height":760,"content":"# ğŸŒ AI Customer Support Assistant - Cloud Version\n\n## What this workflow does:\nThis AI-powered customer support automation processes incoming support requests via email or chat, analyzes them using AI, retrieves relevant context, and generates draft responses for support agents.\n\n## Key Features:\nâœ… **Multi-channel Input**: Email & chat triggers\nâœ… **AI-powered Analysis**: Extracts sentiment, urgency, and key information\nâœ… **Context Integration**: Combines product manuals, ERP data, and support history\nâœ… **Draft Response Generation**: Creates professional responses in German\nâœ… **Human-in-the-loop**: Approval workflow before sending to customers\n\n## Demo Instructions:\n1. Use the Chat interface to test with sample customer queries\n2. Or send test emails to trigger the email workflow\n3. Watch how AI analyzes and generates contextual responses\n\n**ğŸŒ This is the CLOUD version using OpenAI and Google services**"},"typeVersion":1},{"id":"918dd7a6-1c69-43ed-872d-052ebf20a396","name":"ğŸ“§ Email Input","type":"n8n-nodes-base.stickyNote","position":[500,300],"parameters":{"color":2,"width":280,"height":320,"content":"## ğŸ“§ Email Trigger\n\n**Purpose**: Monitors Gmail for incoming customer support requests\n\n**How it works**:\nâ€¢ Polls Gmail every minute for new emails\nâ€¢ Filters can be configured for specific labels/criteria\nâ€¢ Extracts email content, sender info, and metadata\n\n**Demo tip**: Send a test email to see this in action!"},"typeVersion":1},{"id":"cd753c63-7f5f-4e44-901a-d23eca0cb8e9","name":"ğŸ“§ Support Email Received","type":"n8n-nodes-base.gmailTrigger","position":[620,660],"parameters":{"filters":{},"pollTimes":{"item":[{"mode":"everyMinute"}]}},"credentials":{"gmailOAuth2":{"id":"I74VnrmPeKRcOolp","name":"Gmail account dummy@mail.com"}},"typeVersion":1.2},{"id":"175a7569-f8d5-49b6-95ca-a83026b2aea4","name":"ğŸ’¬ Chat Input","type":"n8n-nodes-base.stickyNote","position":[480,1160],"parameters":{"color":2,"width":280,"height":320,"content":"## ğŸ’¬ Chat Trigger\n\n**Purpose**: Provides a real-time chat interface for testing\n\n**How it works**:\nâ€¢ Creates a webhook URL for chat interactions\nâ€¢ Ideal for demos and testing scenarios\nâ€¢ Processes messages instantly\n\n**Demo tip**: Perfect for live demonstrations!"},"typeVersion":1},{"id":"f9f43182-9113-4ba0-b2a9-b82f3f9b5d46","name":"ğŸ§  AI Analysis","type":"n8n-nodes-base.stickyNote","position":[940,300],"parameters":{"color":3,"width":300,"height":380,"content":"## ğŸ§  AI Information Extractor\n\n**Purpose**: Analyzes customer messages with AI to extract structured data\n\n**Extracts**:\nâ€¢ Category (technical, billing, sales, etc.)\nâ€¢ Urgency level (low, medium, high, critical)\nâ€¢ Customer sentiment\nâ€¢ Keywords for context search\nâ€¢ Product identifiers\nâ€¢ Required action type\n\n**AI Model**: OpenAI GPT-4o-mini"},"typeVersion":1},{"id":"99ce470b-9c71-4303-a515-d197bfbf2d78","name":"ğŸ¤– OpenAI Model (Extractor)","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[960,980],"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4o-mini"},"options":{}},"credentials":{"openAiApi":{"id":"M0gBX6dGinkN0Qym","name":"OpenAi account (n8n project)"}},"typeVersion":1.2},{"id":"e55da351-bb97-49a8-bbe7-f9f5814f7874","name":"ğŸ“Š Context Data","type":"n8n-nodes-base.stickyNote","position":[1540,300],"parameters":{"color":4,"width":300,"height":380,"content":"## ğŸ“Š Historical Support Data\n\n**Purpose**: Retrieves previous support cases for context\n\n**Data Source**: Google Sheets with historical customer interactions\n\n**Contains**:\nâ€¢ Previous questions & answers\nâ€¢ Common issues & solutions\nâ€¢ Response templates\nâ€¢ Product-specific guidance\n\n**Why important**: Ensures consistent, high-quality responses"},"typeVersion":1},{"id":"aaf740e0-d78b-41d3-ba92-811c32b06f76","name":"ğŸ“Š Historical Support Cases","type":"n8n-nodes-base.googleSheets","position":[1540,780],"parameters":{"options":{},"sheetName":{"__rl":true,"mode":"list","value":1526853854,"cachedResultUrl":"https://docs.google.com/spreadsheets/d/1iiUzIfOoza0czupn_-4oTY6eOmH4vSENwnjSJ6Uxen4/edit#gid=1526853854","cachedResultName":"zeiss_primotech_support"},"documentId":{"__rl":true,"mode":"list","value":"1iiUzIfOoza0czupn_-4oTY6eOmH4vSENwnjSJ6Uxen4","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1iiUzIfOoza0czupn_-4oTY6eOmH4vSENwnjSJ6Uxen4/edit?usp=drivesdk","cachedResultName":"Zeiss Primotech Demo customer requests"}},"credentials":{"googleSheetsOAuth2Api":{"id":"cZ8QhseWRie9tDzV","name":"Google Sheets account dummy@mail.com"}},"typeVersion":4.5},{"id":"16e63750-b911-458d-b18d-7ced534dbc44","name":"ğŸ“‹ Aggregate Support Data","type":"n8n-nodes-base.aggregate","position":[1740,780],"parameters":{"options":{},"aggregate":"aggregateAllItemData"},"typeVersion":1},{"id":"00c1c023-982b-49f7-a422-f02a3aa1c2a7","name":"ğŸ“š Knowledge Base","type":"n8n-nodes-base.stickyNote","position":[1160,980],"parameters":{"color":4,"width":300,"height":440,"content":"## ğŸ“š Product Knowledge Base\n\n**Purpose**: Accesses comprehensive product documentation\n\n**Data Source**: Google Drive (Primotech Manual PDF)\n\n**Contains**:\nâ€¢ Technical specifications\nâ€¢ Operating instructions\nâ€¢ Troubleshooting guides\nâ€¢ Safety information\n\n**Processing**: PDF text extraction for AI analysis\n\n**Cloud advantage**: Always up-to-date documentation"},"typeVersion":1},{"id":"d4689f32-4c6c-4fab-94ef-4631b7b07632","name":"ğŸ“š Download Product Manual","type":"n8n-nodes-base.googleDrive","position":[1540,1140],"parameters":{"fileId":{"__rl":true,"mode":"list","value":"1_MKUQLEw2RS8k-QgAP5rtw-tD49A82lG","cachedResultUrl":"https://drive.google.com/file/d/1_MKUQLEw2RS8k-QgAP5rtw-tD49A82lG/view?usp=drivesdk","cachedResultName":"Primotech_Manual.pdf"},"options":{},"operation":"download"},"credentials":{"googleDriveOAuth2Api":{"id":"urrYsyCll4whiZup","name":"Google Drive account"}},"typeVersion":3},{"id":"c291af40-8db0-4050-ad29-17774465cdb0","name":"ğŸ“„ Extract PDF Content","type":"n8n-nodes-base.extractFromFile","position":[1740,1140],"parameters":{"options":{},"operation":"pdf"},"typeVersion":1},{"id":"e9a2cbd2-07eb-41a3-9333-2a3d4b936fe2","name":"ğŸ¢ ERP Integration","type":"n8n-nodes-base.stickyNote","position":[1500,1700],"parameters":{"color":5,"width":440,"height":360,"content":"## ğŸ¢ ERP System Integration\n\n**Purpose**: Retrieves customer & inventory data\n\n**Data Source**: Mock ERP API (demo purposes)\n\n**Provides**:\nâ€¢ Customer account information\nâ€¢ Order history\nâ€¢ Product availability\nâ€¢ Spare part pricing\n\n**Note**: In production, this would connect to your real ERP system\n\n**Cloud benefit**: Real-time data access"},"typeVersion":1},{"id":"861dd2a5-b3ad-463c-aa19-f79c7b51c424","name":"ğŸ¢ Check ERP System","type":"n8n-nodes-base.httpRequest","position":[1560,1500],"parameters":{"url":"https://run.mocky.io/v3/d8892875-55d6-449d-bab3-3cb7a7b419c0","options":{}},"typeVersion":3},{"id":"578d7499-4c72-4181-b1c8-89b05d3bdae0","name":"ğŸ¤– AI Response Generation","type":"n8n-nodes-base.stickyNote","position":[2000,1020],"parameters":{"color":3,"width":320,"height":400,"content":"## ğŸ¤– Response Generation\n\n**Purpose**: Creates professional customer responses using AI\n\n**AI Model**: OpenAI GPT-4o-mini\n\n**Input Context**:\nâ€¢ Customer's original message\nâ€¢ Extracted information (sentiment, urgency, etc.)\nâ€¢ Product manual content\nâ€¢ Historical support cases\nâ€¢ ERP data (pricing, availability)\n\n**Output**: Professional German response following company standards"},"typeVersion":1},{"id":"9858ac0e-2f3a-4476-a892-25c51b6dd654","name":"ğŸ¤– Generate Customer Response","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[1960,1500],"parameters":{"text":"=This GPT acts as an expert customer support agent designed to draft thoughtful, accurate responses to customer queries. It takes in customer questions and leverages internal product documentation and a history of previously answered queries to prewrite complete and contextually appropriate replies. The GPT uses the full content of \n\n1. the uploaded Primotech Instruction Manual (in German): \n\n2. a CSV dataset of historical customer questions: {{ $('ğŸ“‹ Aggregate Support Data').item.json.data.toJsonString() }}\n\n3. Customer's original query: {{ \n$('Chat Message Received').isExecuted && $('Chat Message Received').last().json.chatInput;\n$('ğŸ“§ Support Email Received') && $('ğŸ“§ Support Email Received').item.json.snippet \n$('When clicking â€˜Execute workflowâ€™').isExecuted && $('When clicking â€˜Execute workflowâ€™').item.json.snippet\n}} \n\nand answers related to ZEISS Primotech microscopes. These sources provide comprehensive technical, usage, troubleshooting, and product-specific guidance.\n\nThe assistant aims to reduce agent workload by anticipating common follow-up questions, referencing appropriate product knowledge, and maintaining a polite, clear, and supportive tone. It is optimized for high response accuracy, minimal ambiguity, and internal efficiency.\n\nThe assistant never performs web searches. When the available context is insufficient to fully answer a query, it does not generate a customer email. Instead, it presents a warning for the human agent and offers any possibly relevant internal context that may assist in formulating a manual response.\n\nIt avoids answering questions that cannot be supported by available documentation and flags those for manual review. When generating responses, it uses complete, customer-facing sentences, structured for easy review and editing by human support agents, and may include links or references when based on internal content. Clarification is only requested when strictly necessary. If required data is missing, the assistant highlights placeholders for agent completion.\n\nAll responses that are complete must follow this structure:\n- Use a proper salutation starting with 'Sehr geehrter Herr' or 'Sehr geehrte Frau' followed by the customer's last name, if available. If no name is provided, use 'Sehr geehrte/r Kunde/in,'.\n- Begin with 'herzlichen Dank fÃ¼r Ihre Nachricht.'\n- Then insert the drafted response body.\n- If the request involves a spare part, the assistant uses the following API response and includes the relevant spare part name and price from the returned JSON: {{ $json.inventory.toJsonString() }}\n- Close with: 'Bei weiteren Fragen stehen wir Ihnen gerne zur VerfÃ¼gung, gerne kÃ¶nnen sie auch unsere (HILFE Seite)[http://www.zeiss.de] besuchen.' and 'Ich wÃ¼nsche Ihnen einen schÃ¶nen Tag!'\n\nThe assistant uses professional and accessible language, aligned with the tone expected in technical product support, and maintains a helpful and competent demeanor throughout.","promptType":"define"},"typeVersion":1.6,"alwaysOutputData":false},{"id":"263a08b7-c29a-4556-af0d-2a42c7981f0f","name":"ğŸ¤– OpenAI Model (Generator)","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[1980,1680],"parameters":{"model":{"__rl":true,"mode":"list","value":"gpt-4o-mini"},"options":{}},"credentials":{"openAiApi":{"id":"M0gBX6dGinkN0Qym","name":"OpenAi account (n8n project)"}},"typeVersion":1.2},{"id":"769b302a-63b2-4801-9b0c-bb25d1f3e432","name":"ğŸ‘¥ Quality Control","type":"n8n-nodes-base.stickyNote","position":[2420,900],"parameters":{"color":6,"width":320,"height":460,"content":"## ğŸ‘¥ Human-in-the-Loop Approval\n\n**Purpose**: Ensures quality control before sending responses\n\n**Process**:\n1. AI-generated response is sent to support agent\n2. Agent reviews and can approve/reject/modify\n3. Only approved responses are sent to customers\n\n**Benefits**:\nâ€¢ Quality assurance\nâ€¢ Learning from modifications\nâ€¢ Regulatory compliance\n\n**Note**: Critical for maintaining customer trust"},"typeVersion":1},{"id":"33aa86d8-f613-4d9b-921c-781c796b23d1","name":"ğŸ“§ Email or Chat?","type":"n8n-nodes-base.if","position":[2280,1500],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"2473fa5c-8b22-479c-95e7-583d4adb934f","operator":{"type":"boolean","operation":"true","singleValue":true},"leftValue":"={{ $('ğŸ“§ Support Email Received').isExecuted }}","rightValue":"true"}]}},"typeVersion":2.2,"alwaysOutputData":false},{"id":"8eee920b-1a44-4a8a-8db9-6ca32d9d0083","name":"ğŸ“§ Request Approval (Email)","type":"n8n-nodes-base.gmail","position":[2460,1400],"webhookId":"7e79cf64-9f20-4968-9bca-3f4dca48ec4c","parameters":{"sendTo":"dummy@mail.com","message":"=A customer support response has been generated and requires your approval:\n\n**Customer Query**: \n{{ \n$('Chat Message Received').isExecuted ?? $('Chat Message Received').last().json.chatInput\n$('ğŸ“§ Support Email Received').isExecuted ?? $('ğŸ“§ Support Email Received').item.json.snippet \n$('When clicking â€˜Execute workflowâ€™').isExecuted ?? $('When clicking â€˜Execute workflowâ€™').item.json.snippet\n}}\n\n**Generated Response**:\n{{ $json.text }}\n\nPlease review and approve/reject this response.","options":{},"subject":"Customer Support Response - Approval Required","operation":"sendAndWait","approvalOptions":{"values":{"approvalType":"double"}}},"credentials":{"gmailOAuth2":{"id":"I74VnrmPeKRcOolp","name":"Gmail account dummy@mail.com"}},"typeVersion":2.1},{"id":"eee108b0-2d0d-4140-b298-ac0a6bb4422e","name":"ğŸ“¤ Send Response to Customer","type":"n8n-nodes-base.gmail","position":[2680,1400],"webhookId":"c994c7a5-5edb-4167-81dd-22e33625450a","parameters":{"sendTo":"={{ $('ğŸ“§ Support Email Received').item.json.From }}","message":"={{ $('ğŸ¤– Generate Customer Response').item.json.text }}","options":{},"subject":"Re: Your Support Request"},"credentials":{"gmailOAuth2":{"id":"I74VnrmPeKRcOolp","name":"Gmail account dummy@mail.com"}},"typeVersion":2.1},{"id":"b6bb5258-6b1b-48b1-994b-9dbed3062559","name":"ğŸ“ Format Chat Response","type":"n8n-nodes-base.set","position":[2460,1600],"parameters":{"options":{},"assignments":{"assignments":[{"id":"409c228d-783f-4e7f-aa47-f0271d8409f8","name":"text","type":"string","value":"={{ $json.text }}"}]}},"typeVersion":3.4},{"id":"3815458b-3b11-472f-9718-f9fd523b3325","name":"Chat Message Received","type":"@n8n/n8n-nodes-langchain.chatTrigger","position":[620,1020],"webhookId":"3ec1feb8-fc70-4e24-9370-debc47defe81","parameters":{"options":{}},"typeVersion":1.1},{"id":"9f6013c5-f25f-4134-b9b3-9eed10e10db8","name":"AI Information Extractor","type":"@n8n/n8n-nodes-langchain.informationExtractor","position":[940,780],"parameters":{"text":"={{ $json.chatInput ? $json.chatInput : $json.snippet }}","options":{},"schemaType":"manual","inputSchema":"{\n  \"type\": \"object\",\n  \"required\": [\"category\", \"urgency\", \"sentiment\", \"keywords\", \"productIdentifiers\", \"customerInfo\", \"requiredAction\"],\n  \"properties\": {\n    \"category\": {\n      \"type\": \"string\",\n      \"enum\": [\"technical\", \"billing\", \"sales\", \"returns\", \"general\"],\n      \"description\": \"The primary category of the customer request\"\n    },\n    \"urgency\": {\n      \"type\": \"string\",\n      \"enum\": [\"low\", \"medium\", \"high\", \"critical\"],\n      \"description\": \"How time-sensitive the request is\"\n    },\n    \"sentiment\": {\n      \"type\": \"string\",\n      \"enum\": [\"positive\", \"neutral\", \"negative\", \"very_negative\"],\n      \"description\": \"The emotional tone of the customer's message\"\n    },\n    \"keywords\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      },\n      \"description\": \"Key terms extracted from the request for searching knowledge base and ERP\"\n    },\n    \"productIdentifiers\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"type\": {\n            \"type\": \"string\",\n            \"enum\": [\"model\", \"serial\", \"part\"]\n          },\n          \"value\": {\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"description\": \"Any product numbers, models, or parts mentioned in the request\"\n    },\n    \"customerInfo\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"firstName\": {\n          \"type\": \"string\"\n        },\n        \"lastName\": {\n          \"type\": \"string\"\n        },\n        \"customerId\": {\n          \"type\": \"string\",\n          \"description\": \"CRM Customer Id\"\n        },\n        \"mentionsCompetitor\": {\n          \"type\": \"boolean\",\n          \"description\": \"Customer references a competitor product or service\"\n        }\n      }\n    },\n    \"requiredAction\": {\n      \"type\": \"string\",\n      \"enum\": [\"information\", \"replacement\", \"refund\", \"repair\", \"callback\", \"escalation\"],\n      \"description\": \"The primary action needed to resolve the customer's request\"\n    }\n  }}"},"typeVersion":1},{"id":"7fc3e443-9653-4706-a612-413fb6df1e23","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[0,800],"parameters":{"color":7,"width":440,"height":200,"content":"## How to run a demo\n- add google / openai credentials\n- change email of approver to something you can access"},"typeVersion":1}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"583ed6b5-00f7-4fbf-8354-5740c8c59376","connections":{"ğŸ“§ Email or Chat?":{"main":[[{"node":"ğŸ“§ Request Approval (Email)","type":"main","index":0}],[{"node":"ğŸ“ Format Chat Response","type":"main","index":0}]]},"Chat Message Received":{"main":[[{"node":"AI Information Extractor","type":"main","index":0}]]},"ğŸ¢ Check ERP System":{"main":[[{"node":"ğŸ¤– Generate Customer Response","type":"main","index":0}]]},"AI Information Extractor":{"main":[[{"node":"ğŸ“Š Historical Support Cases","type":"main","index":0}]]},"ğŸ“„ Extract PDF Content":{"main":[[{"node":"ğŸ¢ Check ERP System","type":"main","index":0}]]},"ğŸ“‹ Aggregate Support Data":{"main":[[{"node":"ğŸ“š Download Product Manual","type":"main","index":0}]]},"ğŸ“§ Support Email Received":{"main":[[{"node":"AI Information Extractor","type":"main","index":0}]]},"ğŸ“š Download Product Manual":{"main":[[{"node":"ğŸ“„ Extract PDF Content","type":"main","index":0}]]},"ğŸ“Š Historical Support Cases":{"main":[[{"node":"ğŸ“‹ Aggregate Support Data","type":"main","index":0}]]},"ğŸ“§ Request Approval (Email)":{"main":[[{"node":"ğŸ“¤ Send Response to Customer","type":"main","index":0}]]},"ğŸ¤– OpenAI Model (Extractor)":{"ai_languageModel":[[{"node":"AI Information Extractor","type":"ai_languageModel","index":0}]]},"ğŸ¤– OpenAI Model (Generator)":{"ai_languageModel":[[{"node":"ğŸ¤– Generate Customer Response","type":"ai_languageModel","index":0}]]},"ğŸ¤– Generate Customer Response":{"main":[[{"node":"ğŸ“§ Email or Chat?","type":"main","index":0}]]}}}