{"id":"cNNZ3M4oqFQhVgJc","meta":{"instanceId":"ea2b41532677d34614d95d13d7d2ccb694657be482144baf71e7140df3b2a853","templateCredsSetupCompleted":true},"name":"AI-Powered WhatsApp Seller Bot with Google Sheets Lookup","tags":[],"nodes":[{"id":"e584cd33-a6da-483f-9de4-4f9e186eb538","name":"AI Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[336,-96],"parameters":{"text":"={{ $json.body.data.message.conversation }}","options":{"systemMessage":"You represent X company, Your name is Ahmed. Please answer customer inquiries using the information provided in the Google Sheet. Please send an email to the customer service representative only if the customer requests to purchase an item. Before sending the email, ask the customer for their name and phone number, delivery or pickup date, and send them to the customer service representative via Email.\nPhone number format is 10 digits starts with 05 (05XXXXXXXX).\nSpeak with Customers in Saudi dialect.\nYou should welcome the user firstly with (ŸáŸÑÿß Ÿàÿ∫ŸÑÿß).\nDon't give any answers outside the provided Google Sheet."},"promptType":"define"},"typeVersion":2},{"id":"62c4d503-ad9e-4b3e-903a-db7392771020","name":"Send a message in Gmail","type":"n8n-nodes-base.gmailTool","position":[784,160],"webhookId":"9fe4c701-9d99-4ae3-9b39-52a978171f4b","parameters":{"sendTo":"Customer Service Email","message":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}","options":{"appendAttribution":false},"subject":"New Purchase Request ","emailType":"text"},"credentials":{"gmailOAuth2":{"id":"h3RnkjQjRABg68QN","name":"GmailAuthentication"}},"typeVersion":2.1},{"id":"58f5ed7f-5508-4802-add9-e732ed02ab70","name":"Get row(s) in sheet in Google Sheets","type":"n8n-nodes-base.googleSheetsTool","position":[592,240],"parameters":{"options":{},"sheetName":{"__rl":true,"mode":"list","value":"gid=0","cachedResultUrl":"Your Google Sheet URL","cachedResultName":"Sheet1"},"documentId":{"__rl":true,"mode":"list","value":"1m1Do9umLUVyCzqpCS75zvCBSddtwWw4lAok2QHHKWKg","cachedResultUrl":"Your Google Sheet URL","cachedResultName":"Your Company Items"}},"credentials":{"googleSheetsOAuth2Api":{"id":"KJ3WD4ZJZo6YMqm3","name":"Google Sheets account"}},"typeVersion":4.6},{"id":"fa4accc6-b622-4fd3-8b2b-eba606ce8cb2","name":"DeepSeek Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatDeepSeek","position":[176,208],"parameters":{"options":{}},"credentials":{"deepSeekApi":{"id":"hyKdJBiLLtHwOZ4h","name":"DeepSeek API Account"}},"typeVersion":1},{"id":"33806930-5fb1-4ee1-afeb-f0741a6691c7","name":"If message not from group and not outbound","type":"n8n-nodes-base.if","position":[176,-256],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"419382f9-3a23-40ba-afa1-33d71252d2e7","operator":{"type":"boolean","operation":"equals"},"leftValue":"={{ $json.body.data.key.fromMe }}","rightValue":"={{false}}"},{"id":"df484897-bdd3-490f-9902-0b2b51906bd1","operator":{"type":"boolean","operation":"equals"},"leftValue":"={{ $json.body.data.key.remoteJid.includes('@g.us') }}","rightValue":"={{false}}"},{"id":"6d2be59c-30bd-4de3-a36b-720adaa5cbcf","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"","rightValue":""}]}},"typeVersion":2.2},{"id":"4251d06b-1440-410b-a351-7d1f1033e8e8","name":"No Operation, do nothing","type":"n8n-nodes-base.noOp","position":[464,-240],"parameters":{},"typeVersion":1},{"id":"42fafb47-7405-4c0e-8d14-f4012f9e5d01","name":"Enviar texto","type":"n8n-nodes-evolution-api.evolutionApi","position":[704,-96],"parameters":{"resource":"messages-api","remoteJid":"={{ $('Webhook: WhatsApp Message Trigger').item.json.body.data.key.remoteJid }}","messageText":"={{ $json.output }}","instanceName":"Your Instance Name","options_message":{}},"credentials":{"evolutionApi":{"id":"OfCJPxnswdkJBefM","name":"Evolution account"}},"typeVersion":1},{"id":"85a788eb-f660-4537-b9e3-d195ff309f2d","name":"Webhook: WhatsApp Message Trigger","type":"n8n-nodes-base.webhook","position":[-16,-256],"webhookId":"da45cd88-1b08-45b5-bb70-a11688365804","parameters":{"path":"whatsAppListen","options":{},"httpMethod":"POST"},"typeVersion":2},{"id":"36cd632d-e0fb-490f-b821-ab96d8cf255b","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-608,-112],"parameters":{"width":544,"height":384,"content":"## üöÄ AI-Powered WhatsApp Seller Bot with Google Sheets Lookup\n\n### This workflow:\n- **Listens** for inbound WhatsApp messages via webhook  \n- **Uses** a LangChain AI Agent (DeepSeek) to answer in Saudi dialect, sourcing product info from Google Sheets  \n- **Welcomes** customers with ‚ÄúŸáŸÑÿß Ÿàÿ∫ŸÑÿß‚Äù and collects name, phone, and delivery/pickup details  \n- **Prompts** an email notification to your service rep only when the customer is ready to purchase  \n- **Ensures** every conversation stays tied to your sales process without missing a lead  \n\nIdeal for ecommerce teams who want instant, data-driven replies and seamless handoff to sales staff."},"typeVersion":1},{"id":"858bc82c-a986-4805-be88-85570918c90e","name":"Chat Memory with Postgres","type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","position":[352,112],"parameters":{"sessionKey":"={{ $('Webhook: WhatsApp Message Trigger').item.json.body.data.key.remoteJid }}","sessionIdType":"customKey","contextWindowLength":1000},"credentials":{"postgres":{"id":"S1VWsGUdIS78Fgpy","name":"Postgres account"}},"typeVersion":1.3}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"1d94995f-5416-42a7-87ef-893c9d7a44df","connections":{"AI Agent":{"main":[[{"node":"Enviar texto","type":"main","index":0}]]},"DeepSeek Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Send a message in Gmail":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Chat Memory with Postgres":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"Webhook: WhatsApp Message Trigger":{"main":[[{"node":"If message not from group and not outbound","type":"main","index":0}]]},"Get row(s) in sheet in Google Sheets":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"If message not from group and not outbound":{"main":[[{"node":"AI Agent","type":"main","index":0}],[{"node":"No Operation, do nothing","type":"main","index":0}]]}}}